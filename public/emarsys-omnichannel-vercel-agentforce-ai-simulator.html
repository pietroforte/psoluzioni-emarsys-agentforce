
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Agent Force AI Simulator</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
    label, select, textarea, button { display: block; margin-top: 1rem; width: 100%; }
    h1 { display: flex; align-items: center; gap: 1rem; font-size: 1.5rem; }
    .badge { padding: 0.2rem 0.6rem; border-radius: 6px; display: inline-block; margin-top: 0.5rem; }
    .badge-positive { background-color: #d4edda; color: #155724; }
    .badge-negative { background-color: #f8d7da; color: #721c24; }
    .badge-neutral  { background-color: #fff3cd; color: #856404; }
    #helperPanel { background: #f1f1f1; padding: 1rem; margin-top: 2rem; border-left: 4px solid #5A2D82; }
  </style>
</head>
<body>

<h1>
  <img src="/emarsys-logo.png" alt="Emarsys Logo" style="height: 32px;">
  <span>Agent Force AI Simulator</span>
</h1>

<label for="customerSelect">Select Customer</label>
<select id="customerSelect">
  <option value="">-- Choose --</option>
  <option value="C001">Anna (C001)</option>
  <option value="C002">Lucas (C002)</option>
  <option value="C003">Sofia (C003)</option>
</select>

<div id="aiSuggestionBox"></div>
<div id="lifecycleBadgeBox"></div>

<label for="presetNotes">Choose an Agent Note</label>
<select id="presetNotes">
  <option value="">-- Choose Example --</option>
  <option value="Customer was angry about loyalty points.">Customer was angry about loyalty points.</option>
  <option value="Customer thanked me for solving an issue.">Customer thanked me for solving an issue.</option>
  <option value="Customer asked about campaign expiration.">Customer asked about campaign expiration.</option>
</select>

<label for="agentNote">Agent Note</label>
<textarea id="agentNote" rows="3"></textarea>
<button onclick="analyzeSentiment()">Analyze Sentiment with AI</button>
<div id="sentimentSummaryBox"></div>

<div id="helperPanel">
  <strong>üîç What‚Äôs happening?</strong>
  <p>This simulator demonstrates how agents can use AI to handle customer interactions within a loyalty campaign environment. Try selecting a contact, using a sample note, and triggering the sentiment engine.</p>
</div>

<script>
document.getElementById("presetNotes").addEventListener("change", (e) => {
  document.getElementById("agentNote").value = e.target.value;
});

document.getElementById("customerSelect").addEventListener("change", async (e) => {
  const contactID = e.target.value;
  if (!contactID) return;

  const aiRes = await fetch(`/api/ai/recommendation?contactID=${contactID}`);
  const aiData = await aiRes.json();
  document.getElementById("aiSuggestionBox").innerText =
    `üí° AI Suggestion: ${aiData.action} (${Math.round(aiData.confidence * 100)}% confidence)`;

  const lifecycleRes = await fetch(`/api/ai/lifecycle?contactID=${contactID}`);
  const lifecycle = await lifecycleRes.json();
  document.getElementById("lifecycleBadgeBox").innerText =
    `üìä Predicted Lifecycle: ${lifecycle.stage} (${Math.round(lifecycle.confidence * 100)}% confidence)`;
});

async function analyzeSentiment() {
  const note = document.getElementById("agentNote").value;
  if (!note) return alert("Please enter a note.");

  const res = await fetch("/api/ai/sentiment", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ text: note })
  });

  const data = await res.json();
  const box = document.getElementById("sentimentSummaryBox");
  box.innerText = `üß† AI Summary: ${data.summary} (Sentiment: ${data.sentiment})`;
  box.className = "badge badge-" + data.sentiment;
}
</script>

</body>
</html>
